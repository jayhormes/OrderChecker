<!DOCTYPE HTML>
<html>
	<head>
		<title>Test</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>				
	</head>
	<body class="is-preload">

		<script>
			function ChangeString(input){
				var NewStringValue=input;
				document.getElementById("MessageArea").innerHTML=NewStringValue;
			}
		</script>
		<script>
			function GetData(UserAccount, UserPhone) {
				const uri = 'https://script.google.com/macros/s/AKfycbxhsmRvtPCDZ2kyn2uFVTx44yX7pT-XyBgjf1mwx-mpZ5_olSY/exec';
				fetch(uri, {
				method:'POST',
				body:encodeURI(JSON.stringify({
					ssid: '1TSf8Z-u0VVE0mSIxbx1gt83XEoJo3_orJE33RAMZ_cY',
					sheetName: '工作表1',
					accountString: UserAccount,
					phoneNumber: UserPhone,				
				})),
				headers: {
					'Content-Type': 'application/x-www-form-urlencoded; charset=utf-8'
				}
				})
				.then(res => {
					return res.json();   // 使用 json() 可以得到 json 物件
				}).then(result => {
					console.log(result); // 得到 {name: "oxxo", age: 18, text: "你的名字是 oxxo，年紀 18 歲～"}
					if (result.length != 0) {
						ShowString = "<p>" + result + "</p>";
					} else {
						ShowString = "<p>" + "查無此人" + "</p>";
					}
					ChangeString(ShowString);
				});	
			}
		</script>		
		<script>
            function GetSheetData(){
				var UserAccount = document.getElementById("AccountStringTextBox").value;
                var UserPhone = document.getElementById("PhoneStringTextBox").value;

				ShowString = "<p>查詢中</p>";
				ChangeString(ShowString);

				console.log(UserAccount);
				console.log(UserPhone);

				GetData(UserAccount, UserPhone);

            }
		</script>				
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<section id="main">
						<header>
							<span class="avatar"><img src="images/avatar.jpg" alt="" /></span>
							<p>請輸入您的嘖嘖帳號</p>
							<input type="text" id="AccountStringTextBox" textarea style="border:3px orange dashed;"></textarea>
							<p></p>
							<p>請輸入手機號碼末三碼</p>
							<input type="text" id="PhoneStringTextBox" textarea style="border:3px orange dashed;"></textarea>
							<p></p>
							<input type="button" value="查詢" onclick="GetSheetData()">	
							<p></p>		
							<p id="MessageArea"></p>
							<p></p>					
						</header>
						<footer>
							<ul class="icons">
								<li><a href="#" class="icon brands fa-twitter">Twitter</a></li>
								<li><a href="#" class="icon brands fa-instagram">Instagram</a></li>
								<li><a href="#" class="icon brands fa-facebook-f">Facebook</a></li>
							</ul>
						</footer>
					</section>

				<!-- Footer -->
					<footer id="footer">
						<ul class="copyright">
							<li>&copy; Angy Chain</li><li>Design: Jay Hormes</li>
						</ul>
					</footer>

			</div>

		<!-- Scripts -->
			<script>
				if ('addEventListener' in window) {
					window.addEventListener('load', function() { document.body.className = document.body.className.replace(/\bis-preload\b/, ''); });
					document.body.className += (navigator.userAgent.match(/(MSIE|rv:11\.0)/) ? ' is-ie' : '');
				}
			</script>

	</body>
</html>